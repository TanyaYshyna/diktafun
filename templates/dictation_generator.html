<!DOCTYPE html>
<html>

<head>
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∏–∫—Ç–∞–Ω—Ç–æ–≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style_color.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/style_dictation_generator.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- FancyTree -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.fancytree@2/dist/skin-lion/ui.fancytree.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery.fancytree@2.38.2/dist/jquery.fancytree-all-deps.min.js"></script>

    <!-- WaveSurfer -->
    <link rel="icon" href="data:,"> <!-- –ü—É—Å—Ç–∞—è –∏–∫–æ–Ω–∫–∞ -->
    <script src="https://unpkg.com/wavesurfer.js@6.6.2/dist/wavesurfer.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@6.6.2/dist/plugin/wavesurfer.regions.min.js"></script>
</head>

<body>
   <div class="topbar">
        <img src="/static/icons/logo.svg" class="logo">
        <div class="user-section" id="user-section">
            <a href="/user/profile" class="username">
                {{ current_user.username }}
            </a>
            <button class="streak">üî• {{ current_user.streak_days }} –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</button>
            <a href="/user/login">–í–æ–π—Ç–∏</a>
            <a href="/user/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        </div>
    </div>


    <div class="panel">
        <h2 id="dictation-id">–ù–æ–≤—ã–π –¥–∏–∫—Ç–∞–Ω—Ç: </h2>
        <div class="container" style="display: flex">
            <div id="langPair" data-original="{{ original_language }}" data-translation="{{ translation_language }}">
                {{ original_language }} ‚áí {{ translation_language }}
            </div>
            <div class="container">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div class="tooltip-wrapper">
                        <button id="openTreeDialogBtn" onclick="openCategoryModal('root')">‚ãØ</button>
                        <pre class="tooltip-text">–í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</pre> <!-- –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                    </div>
                    <pre id="modalTitle">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: </pre>
                    <!-- –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤–æ–º -->
                    <div id="modalOverlay" class="modal-overlay"></div>
                    <div id="categoryModal" class="modal" style="display:none;">
                        <h4>–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É</h4>
                        <div id="treeContainer"></div>

                        <div class="tooltip-wrapper">
                            <button id="btnAddNode"> ‚ûï </button>
                            <div class="tooltip-text">–ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç</div> <!-- –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                        </div>

                        <div class="tooltip-wrapper">
                            <button id="btnDeleteNode"> üóëÔ∏è </button>
                            <div class="tooltip-text">–£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</div> <!-- –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                        </div>

                        <div class="tooltip-wrapper">
                            <button id="btnCancelCategory">‚ùå </button>
                            <div class="tooltip-text">–û—Ç–º–µ–Ω–∞</div> <!-- –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                        </div>

                        <div class="tooltip-wrapper">
                            <button id="btnSelectCategory">‚úÖ </button>
                            <div class="tooltip-text">–í—ã–±—Ä–∞—Ç—å</div> <!-- –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                        </div>
                    </div>
                    <!-- –æ–Ω–æ–∫–Ω—á–∞–Ω–∏–µ ---- –î–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤–æ–º -->
                </div>
            </div>
        </div>



        <label>Title:</label>
        <div class="form-group-line-wrapper">
            <div class="form-group-line">
                <label style="color: var(--color-button-text-lightgreen);">{{ original_language }}:</label>
                <input class="text-input" type="text" id="title" required>
            </div>
            <div class="form-group-line">
                <label style="color: var(--color-button-text-yellow);">{{ translation_language }}:</label>
                <input class="text-input" type="text" id="title_translation" required>
            </div>
        </div>

        <div class="panels-single">
            <div class="toggle-panel">
                <div class="toggle-header" onclick="togglePanel(this)">
                    <span class="arrow">
                        <i data-lucide="chevron-right"></i>
                    </span>
                    <span class="title">–¢–µ–∫—Å—Ç –ø–æ —Ñ—Ä–∞–∑–∞–º</span>
                </div>
                <div id="formGroupRaw" class="form-group form-raw toggle-content">
                    <div class="form-group">
                        <label style="color: var(--color-button-text-yellow);">–¢–µ–∫—Å—Ç –ø–æ —Ñ—Ä–∞–∑–∞–º (/* –ø—Ä–µ–≤–æ–¥):</label>
                        <textarea id="text" type="text" rows="10"></textarea>
                    </div>
                    <button id="split-btn" class="button-color-yellow">–†–∞–∑–±–∏—Ç—å –Ω–∞ —Ñ—Ä–∞–∑—ã –∏ –æ–∑–≤—É—á–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <div class="panels-wagons">
            <!-- –í–ê–ì–û–ù 1 -->
            <div class="left-panel">

                <div class="toggle-panel">
                    <div class="toggle-header" onclick="togglePanel(this)">
                        <span class="arrow">
                            <i data-lucide="chevron-right"></i>
                        </span>
                        <span class="title">–ê—É–¥–∏–æ: </span>
                        <span id="text-original-row" class="text-original">(1) –¢–µ–∫—É—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</span>
                    </div>
                    <div class="toggle-content">
                        <div class="audio-actions">
                            <!-- –†–ê–î–ò–û –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∞—É–¥–∏–æ -->
                            <fieldset class="audio-source">
                                <label>
                                    <input type="radio" name="audioSource-{{key}}" value="auto" checked>
                                    –∞–≤—Ç–æ–ø–µ—Ä–µ–≤–æ–¥
                                </label>
                                <label>
                                    <input type="radio" name="audioSource-{{key}}" value="cut">
                                    –≤—ã—Ä–µ–∑–∫–∞ –∏–∑ –∞—É–¥–∏–æ
                                </label>
                            </fieldset>

                            <button class="button-color-yellow" data-key="{{key}}">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫ —Å—Ç—Ä–æ–∫–µ</button>
                        </div>

                        <div class="form-group-line">
                            <label style="color: var(--color-button-text-lightgreen);">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ:</label>
                            <!-- <input type="file" id="audioFile" accept="audio/*"> -->
                            <!-- –°–ø—Ä—è—Ç–∞–Ω–Ω–æ–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ -->
                            <input type="file" id="audioFile" accept="audio/*" style="display: none;">

                            <!-- –ö—Ä–∞—Å–∏–≤–∞—è –ª–æ–∂–Ω–∞—è –∫–Ω–æ–ø–∫–∞ -->
                            <button id="fakeAudioFileBtn" class="button-color-lightgreen">...</button>

                            <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å -->
                            <div id="audioFileStatus" style="color: var(--color-button-text-lightgreen);">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω
                            </div>
                        </div>

                        <div id="waveWrapper">
                            <div id="waveform"></div>
                        </div>

                        <!-- <label id="text-original-row" class="text-original">(1) –¢–µ–∫—É—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</label> -->

                        <div class="controls-row">
                            <button id="playPauseBtn" onclick="funClick()" class="button-color-lightgreen">
                                <i data-lucide="play"></i>
                            </button>
                            <div class="time-fields">
                                <!-- Start: <span id="startTime">‚Äì</span> ‚Äî End: <span id="endTime">‚Äì</span> -->
                                <label for="startTime">Start:</label>
                                <input type="number" id="startTime" step="0.01" min="0" size="6">

                                <label for="endTime">End:</label>
                                <input type="number" id="endTime" step="0.01" min="0" size="6">
                            </div>

                        </div>

                        <!-- <button class="apply-audio" data-key="{{key}}">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫ —Å—Ç—Ä–æ–∫–µ</button>
                <button id="recognize_words_btn" class="button-color-yellow">–†—Å–ø–æ–∑–Ω–∞—Ç—å —Å–ª–≤–∞ –∏–∑ –∞—É–¥–∏–æ</button> -->
                    </div>
                </div>
            </div>


            <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
            <div class="resizer"></div>

            <!-- –í–ê–ì–û–ù 2 -->
            <div class="right-panel">
                <div class="toggle-panel inner-toggle">
                    <div class="toggle-header" onclick="togglePanel(this)">
                        <span class="arrow">
                            <i data-lucide="chevron-right"></i>
                        </span>
                        <span class="title">–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–∑ –∞—É–¥–∏–æ</span>
                    </div>
                    <div id="formGroupRaw" class="form-group form-raw toggle-content inner-toggle">
                        <button id="recognize_words_btn" class="button-color-yellow">–†—Å–ø–æ–∑–Ω–∞—Ç—å —Å–ª–≤–∞ –∏–∑ –∞—É–¥–∏–æ</button>
                        <div class="form-group">
                            <label style="color: var(--color-button-text-yellow);">–í—Ä–µ–º—è-—Å–ª–æ–≤–æ:</label>
                            <textarea id="text_time_word" type="text" rows="5"></textarea>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <table id="sentences-table">
            <thead>
                <tr>
                    <th>‚Ññ</th>
                    <th>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª/–ø–µ—Ä–µ–≤–æ–¥)</th>
                    <th>–ó–∞–ø–∏—Å—å</th>
                    <th>–ê—É–¥–∏–æ</th>
                    <th class="audio-dependent-column-display ">Start</th>
                    <th class="audio-dependent-column-display ">End</th>
                    <th class="audio-dependent-column-display ">Status</th>
                    <th class="audio-dependent-column-display ">–ò—Å—Ç–æ—á–Ω–∏–∫</th>
                </tr>
            </thead>
            <tbody>
                <!-- –°—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JavaScript -->
            </tbody>
        </table>

    </div>


    <!-- <script type="application/json">
        window.dictationId = "{{ dictation_id }}";
        window.editMode = {{ edit_mode | tojson }};
    </script> -->

    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        lucide.createIcons();
    </script>

    <script id="init-data" type="application/json">
    {{ {
        "dictation_id": dictation_id,
        "editMode": edit_mode,
        "original_language": original_language,
        "translation_language": translation_language,
       "original_data": original_data,
        "translation_data": translation_data,
        "audio_file": audio_file,
        "title": title,
        "level": level,
        "audio_words": audio_words
     } | tojson }}
    </script>
    <script src="{{ url_for('static', filename='js/script_dictation_generator.js') }}"></script>
</body>

</html>